Malware Bazar:
sample name: 4296995e7f14e7b456abaabf589ec07a152d295f9155fbe2b1ddd01f710e3762.exe<br />
md5 hash: f300cd286f233d31193d3509e18a6cbd<br />

Basic Static Analysis:<br />

First: Check when it has been compiled<br />

PEview -> IMAGE_FILE_HEADER -> Time Date Stamp 2021/11/22 lun 13:50:17 UTC.


Second: Check if it is packed (it is packed if the size of raw data is more different(large/small) from virtual size)

IMAGE_SECTION_HEADER .text -> Size of raw data 00013800<br />
                              Virtual size     000136F2        (not packed)<br />

IMAGE_SECTION_HEADER .data -> Size of raw data 00182D64<br />
                              Virtual size     00020200        (packed)<br />

IMAGE_SECTION_HEADER .rsrc -> Size of raw data 00003C00<br />
                              Virtual size     00003C00        (not packed)<br />

do another check if it is packed with PEid and Detect it Easy<br />
ok so, Die and PEid detected (.data) as packed but nothing info about the packer used.<br />

third: Exploring Dynamically Linked Functions with Dependency Walker<br />

kernel32.dll -> GetProcAddress<br />
                LoadLibraryA<br />
		    VirtualAlloc  (typical function for packer)<br />
 		    VirtualFree<br />


other interesting function:<br />
kernel32.dll -> CreateFileA (ok so now we know that create file)<br />
                SetMailslot (maybe it use mailslot to send information in real time to the cnc server)<br />
		GetWindowsDirectory<br />
                GetCPInfo<br />
                EnumCalendarInfoW<br />
		GetMailslotInfo<br />
		isDebuggerPresent (a typical anti-analysis function)<br />
                GetStartupInfoA<br />
                WriteFile<br />
		ReadFile<br />

ok now viewing the .rsrc with Resource Hacker<br />
nothing interesting apart incomprehensible strings<br />


Four: View Strings with Bintext<br />
other incomprensible string, but we found an IP: 26.45.78.26 so we can assume<br />
that this malware use internet connection, so it connect to a cnc server.<br />
ok another interesting string: C:\fibuxopotido\jihanamubol\vepunutepir wavaduz.pdb<br />
this is probably the mailslot that it use to send the information.<br />



Basic Dynamic Analysis:<br />

Procmon + FakeNet + RegShot

Procmon is used to see process tasks (filecreated, directory created, file deleted, ecc..)<br />
FakeNet is used to fake a DNS server, so we redirect the dns resolution to 127.0.0.1 and see the requests that malware do<br />
RegShot is used to see the chenges that malware do in the register. (ex: Persistance HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run)<br />


ProcMon -> (1) the malware create file and open registery (too many to write them) and create an executable with name "rovwer.exe". 
as we can see in the screenshot but to be sure, let's check with Process Explorer..
(2)as we imagined the malware is persistent (autostart location).
![My Image](img/1.PNG)
![My Image](img/2.PNG)
